<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self'; connect-src 'self'; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KontrNahryuk</title>
    <link rel="stylesheet" href="./styles/ui.css" />
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand">üê∑ –ù–∞—Ö—Ä—é–∫</div>
        <nav class="nav">
          <a href="#/functions" id="nav-func">üìÑ –ù–∞–∫–∞–∑–∏</a>
          <a href="#/excel" id="nav-excel">üìä –°—Ç—Ä–æ–π–æ–≤–∫–∞</a>
          <a href="#/dodatok10" id="nav-dodatok10">üìã –î–æ–¥–∞—Ç–æ–∫ 10</a>
          <a href="#/shtat-slice" id="nav-shtat-slice">üî™ –®—Ç–∞—Ç_Slice</a>
          <a href="#/zbd" id="nav-zbd">üìù –ñ–ë–î</a>
          <a href="#/updates" id="nav-updates">Updates</a>
          <a href="#/settings" id="nav-settings">Settings</a>
        </nav>
      </aside>

      <main class="content">
        
        <!-- License system removed - app is now free and open -->
        <section data-route="/functions" class="route">
          <!-- –°–µ–∫—Ü—ñ—è 1: –ü–æ—à—É–∫ —Ç–µ–∫—Å—Ç—É –≤ –Ω–∞–∫–∞–∑—ñ -->
          <div class="card">
            <div class="section-header">
              <h2>–ü–æ—à—É–∫ —Ç–µ–∫—Å—Ç—É –≤ –Ω–∞–∫–∞–∑—ñ</h2>
            </div>

            <!-- –ü–æ–ª–µ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –Ω–∞–∫–∞–∑—É -->
            <div class="form">
              <label class="field">
                <span class="label">–¢–µ–∫—Å—Ç –¥–ª—è –ø–æ—à—É–∫—É</span>
                <input 
                  type="text"
                  class="input" 
                  id="order-text-input" 
                  placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ—à—É–∫—É –≤ –Ω–∞–∫–∞–∑—ñ..."
                />
              </label>
            </div>

            <div class="divider"></div>

            <div class="form">
              <label class="field">
                <span class="label">–î–∂–µ—Ä–µ–ª–æ –¥–ª—è –ø–æ—à—É–∫—É</span>
                <div class="source-selector">
                  <div class="radio-group">
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="single-file" id="source-single" class="nose-radio" checked>
                      <span class="radio-label">–û–¥–∏–Ω —Ñ–∞–π–ª</span>
                    </label>
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="multiple-files" id="source-multiple" class="nose-radio">
                      <span class="radio-label">–î–µ–∫—ñ–ª—å–∫–∞ —Ñ–∞–π–ª—ñ–≤</span>
                    </label>
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="folder" id="source-folder" class="nose-radio">
                      <span class="radio-label">–í—Å—è –ø–∞–ø–∫–∞</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É -->
                  <div class="source-input" id="single-file-input">
                    <label class="file-picker">
                      <input type="file" class="file-input" id="word-file" accept=".doc,.docx" aria-label="–í–∏–±—Ä–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç Word">
                      <span class="file-btn">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª...</span>
                      <span class="file-name">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –¥–µ–∫—ñ–ª—å–∫–æ—Ö —Ñ–∞–π–ª—ñ–≤ -->
                  <div class="source-input" id="multiple-files-input" style="display: none;">
                    <label class="file-picker">
                      <input type="file" class="file-input" id="word-files" accept=".doc,.docx" multiple aria-label="–í–∏–±—Ä–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ Word">
                      <span class="file-btn">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª–∏...</span>
                      <span class="file-name">–§–∞–π–ª–∏ –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ -->
                  <div class="source-input" id="folder-input" style="display: none;">
                    <div class="row">
                      <input class="input" id="folder-path" placeholder="–û–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏‚Ä¶" readonly />
                      <button class="btn" id="choose-folder">–û–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                    </div>
                  </div>
                </div>
              </label>

              <label class="field">
                <span class="label">–ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</span>
                <div class="file-picker">
                  <span class="file-btn" id="choose-result">–û–±—Ä–∞—Ç–∏ –º—ñ—Å—Ü–µ...</span>
                  <span class="file-name" id="result-path-display">–®–ª—è—Ö –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                  <input type="hidden" id="result-path" />
                </div>
              </label>

              <label class="toggle">
                <input type="checkbox" id="t-autopen-search" class="nose" checked />
                <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è</span>
              </label>
            </div>

            <div class="divider"></div>
            <div class="actions-bottom">
              <button class="btn primary" id="btn-process-search">–û–±—Ä–æ–±–∏—Ç–∏</button>
            </div>
          </div>

          <!-- –°–µ–∫—Ü—ñ—è 2: –†–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è -->
          <div class="card" style="margin-top: 12px;">
            <div class="section-header">
              <h2>–†–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è</h2>
            </div>

            <div class="form">
              <label class="field">
                <span class="label">Word –Ω–∞–∫–∞–∑</span>
                <label class="file-picker">
                  <input type="file" class="file-input" id="order-word-file" accept=".doc,.docx" aria-label="–í–∏–±—Ä–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç Word">
                  <span class="file-btn">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª...</span>
                  <span class="file-name">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                </label>
              </label>

              <label class="field">
                <span class="label">Excel –ë–î –∑—ñ —Å–ø–∏—Å–∫–æ–º —ñ–º–µ–Ω</span>
                <div class="file-picker">
                  <span class="file-btn" id="choose-excel">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª...</span>
                  <span class="file-name" id="excel-path-display">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                  <input type="hidden" id="excel-path" />
                </div>
              </label>

              <label class="field">
                <span class="label">–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª–∏—Å—Ç—ñ–≤ –¥–ª—è –æ–±—Ä–æ–±–∫–∏</span>
                <input type="number" id="excel-sheets-count" class="input" value="1" min="1" max="100" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–µ—Ä—à–∏—Ö –ª–∏—Å—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 5)">
              </label>

              <label class="field">
                <span class="label">–ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</span>
                <div class="file-picker">
                  <span class="file-btn" id="choose-order-result">–û–±—Ä–∞—Ç–∏ –º—ñ—Å—Ü–µ...</span>
                  <span class="file-name" id="order-result-path-display">–®–ª—è—Ö –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                  <input type="hidden" id="order-result-path" />
                </div>
              </label>

              <label class="toggle">
                <input type="checkbox" id="t-autopen-order" class="nose" checked />
                <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è</span>
              </label>
            </div>

            <div class="divider"></div>
            <div class="actions-bottom">
              <button class="btn primary" id="btn-process-order">–û–±—Ä–æ–±–∏—Ç–∏</button>
            </div>
          </div>

          <!-- –°–ø—ñ–ª—å–Ω–∏–π –ª–æ–≥ –¥–ª—è –æ–±–æ—Ö —Å–µ–∫—Ü—ñ–π -->
          <div class="card" style="margin-top: 12px;">
            <div class="log-container">
              <div class="log-header">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div style="display: flex; gap: 8px;">
                  <button class="btn ghost small" id="btn-copy-log" title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                  <button class="btn ghost small" id="btn-clear-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              <pre id="log-body" class="log-body"></pre>
            </div>
          </div>
        </section>

        <section data-route="/excel" class="route" hidden>
          <div class="card">
            <h3>üìä –°—Ç—Ä–æ–π–æ–≤–∫–∞</h3>
            <p class="subtitle">–ó–≤–µ–¥–µ–Ω–Ω—è —Å—Ç—Ä–æ–π–æ–≤–∏—Ö –∑ –º—ñ—Å—è—Ü—ñ–≤ –¥–æ –æ—Å–Ω–æ–≤–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ</p>
            
            <div class="excel-container">
              <!-- –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏ -->
              <div class="excel-card">
                <h4>üóÇÔ∏è –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–ü–∞–ø–∫–∞ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</span>
                    <div class="row">
                      <input class="input" id="excel-input-folder" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –∑ Excel —Ñ–∞–π–ª–∞–º–∏..." readonly>
                      <button class="btn" id="excel-select-folder">üìÇ –í–∏–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                    </div>
                  </label>
                  
                  <!-- –ü—Ä–∏—Ö–æ–≤–∞–Ω–æ –¥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤ -->
                  <!-- <div id="excel-files-preview" class="files-preview" style="display: none;">
                    <h5>–ó–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏:</h5>
                    <div id="excel-files-list" class="files-list"></div>
                  </div> -->
                </div>
              </div>

              <!-- –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è -->
              <div class="excel-card">
                <h4>üíæ –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–û–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –∫—É–¥–∏ –±—É–¥–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</span>
                    <div class="row">
                      <input class="input" id="excel-destination-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å —ñ—Å–Ω—É—é—á–∏–π Excel —Ñ–∞–π–ª..." readonly>
                      <button class="btn" id="excel-select-destination">üìÑ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                    </div>
                  </label>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-remember-destination" class="nose" checked>
                      <span>–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ —Ñ–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–µ—Å—ñ–π</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ -->
              <div class="excel-card">
                <h4>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏</h4>
                <div class="form">
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-slice-check" class="nose" checked>
                      <span>Slice_Check</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-mismatches" class="nose" checked>
                      <span>Mismatches</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-sanitizer" class="nose" checked>
                      <span>Sanitizer</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="enable3BSP" class="nose" checked>
                      <span>3–ë–°–ü</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-duplicates" class="nose" checked>
                      <span>–î—É–±–ª—ñ</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-autoopen" class="nose" checked>
                      <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
              <div class="excel-actions">
                <button class="btn primary" id="excel-process-btn">üöÄ –†–æ–∑–ø–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                <button class="btn ghost" id="excel-cancel-btn" style="display: none;">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              </div>
            </div>
          </div>
        </section>

        <section data-route="/updates" class="route" hidden>
          <div class="card">
            <h3>–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É</h3>
            
            <div class="update-info">
              <div class="version-info">
                <p><strong>–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:</strong> <span id="current-version">1.0.0</span></p>
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="update-status">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–Ω–∞–π—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"</span></p>
              </div>
              
              <!-- Release Notes –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –∑–∞–≤–∂–¥–∏) -->
              <div id="current-release-notes-section" class="release-notes-section" style="margin-top: 16px; display: none;">
                <h5>üìù –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é:</h5>
                <div id="current-release-notes-content" class="release-notes-content" style="max-height: 300px; overflow-y: auto; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-top: 8px;"></div>
              </div>
              
              <div id="update-available" class="update-available" hidden>
                <div class="update-details">
                  <h4>–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞ –≤–µ—Ä—Å—ñ—è: <span id="new-version"></span></h4>
                  <p>–†–æ–∑–º—ñ—Ä: <span id="update-size"></span></p>
                  <p>–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ: <span id="update-date"></span></p>
                  
                  <!-- Release Notes -->
                  <div id="release-notes-section" class="release-notes-section" style="margin-top: 16px; display: none;">
                    <h5>üìù –©–æ –Ω–æ–≤–æ–≥–æ:</h5>
                    <div id="release-notes-content" class="release-notes-content" style="max-height: 300px; overflow-y: auto; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-top: 8px;"></div>
                  </div>
                  
                  <div class="update-actions">
                    <a href="#" id="release-notes" target="_blank" class="link">–°–ø–∏—Å–æ–∫ –∑–º—ñ–Ω</a>
                    <button class="btn primary" id="btn-auto-update">üê∑ –û–Ω–æ–≤–∏—Ç–∏ –ù–∞—Ö—Ä—é–∫</button>
                    <button class="btn ghost" id="btn-manual-download">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Ä—É—á–Ω—É</button>
                  </div>
                </div>
              </div>
              
              <div id="mandatory-update" class="mandatory-update" hidden>
                <div class="alert error">
                  <h4>‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h4>
                  <p>–¶–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º –¥–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏</p>
                  <div class="mandatory-actions">
                    <button class="btn primary" id="btn-mandatory-update">–û–Ω–æ–≤–∏—Ç–∏ –∑–∞—Ä–∞–∑</button>
                    <button class="btn ghost" id="btn-exit-app">–í–∏–π—Ç–∏</button>
                  </div>
                </div>
              </div>
              
              <div id="update-progress" class="update-progress" hidden>
                <div class="progress-info">
                  <h4>üê∑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ù–∞—Ö—Ä—é–∫–∞</h4>
                  <p id="progress-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                  <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%; transition: width 0.3s ease;"></div>
                  </div>
                  <div class="progress-details">
                    <span id="progress-percent">0%</span>
                    <span id="progress-speed">0 KB/s</span>
                    <span id="progress-size">0 / 0 MB</span>
                  </div>
                </div>
                <div class="progress-actions">
                  <button class="btn ghost" id="btn-cancel-update">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                  <button class="btn ghost" id="btn-restart-after-update" style="display:none;">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              
              <div id="update-error" class="update-error" hidden>
                <div class="alert error">
                  <h4>–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h4>
                  <p id="error-message"></p>
                  <div class="error-actions">
                    <button class="btn" id="btn-retry-update">–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏</button>
                    <button class="btn ghost" id="btn-save-log">–ó–±–µ—Ä–µ–≥—Ç–∏ –ª–æ–≥</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- License section removed - app is now free and open -->
            
            <div class="update-controls">
              <button class="btn" id="btn-check-updates">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</button>
            </div>
            
            <div class="update-info">
              <div id="update-status">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è" –¥–ª—è –ø–æ—à—É–∫—É –Ω–æ–≤–∏—Ö –≤–µ—Ä—Å—ñ–π</div>
              <div id="update-details" style="display: none;"></div>
            </div>
          </div>
        </section>

        <section data-route="/dodatok10" class="route" hidden>
          <div class="card">
            <h3>üìã –î–æ–¥–∞—Ç–æ–∫ 10</h3>
            <p class="subtitle">–û–±—Ä–æ–±–∫–∞ Excel —Ñ–∞–π–ª—ñ–≤ –¥–ª—è –î–æ–¥–∞—Ç–∫—É 10</p>
            
            <div class="excel-container">
              <!-- –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏ -->
              <div class="excel-card">
                <h4>üóÇÔ∏è –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–ü–∞–ø–∫–∞ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</span>
                    <div class="row">
                      <input class="input" id="dodatok10-input-folder" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –∑ Excel —Ñ–∞–π–ª–∞–º–∏..." readonly>
                      <button class="btn" id="dodatok10-select-folder">üìÇ –í–∏–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                    </div>
                    <small style="opacity: 0.7; display: block; margin-top: 4px;">
                      –°–∫—Ä–∏–ø—Ç —à—É–∫–∞—î —Ñ–∞–π–ª–∏ –∑ –Ω–∞–∑–≤–∞–º–∏: <code>–î–æ–¥.10</code>, <code>–î–æ–¥ 10</code>, <code>–î–æ–¥–∞—Ç–æ–∫ 10</code> (–¥–∞—Ç–∞ –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è)
                    </small>
                  </label>
                </div>
              </div>

              <!-- –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è -->
              <div class="excel-card">
                <h4>üíæ –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–û–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –∫—É–¥–∏ –±—É–¥–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</span>
                    <div class="row">
                      <input class="input" id="dodatok10-destination-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å —ñ—Å–Ω—É—é—á–∏–π Excel —Ñ–∞–π–ª..." readonly>
                      <button class="btn" id="dodatok10-select-destination">üìÑ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                    </div>
                  </label>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-remember-destination" class="nose" checked>
                      <span>–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ —Ñ–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–µ—Å—ñ–π</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ -->
              <div class="excel-card">
                <h4>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏</h4>
                <div class="form">
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-autoopen" class="nose" checked>
                      <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è</span>
                    </label>
                  </div>
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-fnp-check" class="nose">
                      <span>FNP</span>
                    </label>
                  </div>
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-update-status-check" class="nose">
                      <span>–û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å</span>
                    </label>
                  </div>
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-duplicates-check" class="nose">
                      <span>–î—É–±–ª—ñ</span>
                    </label>
                  </div>
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-stroiovka-check" class="nose">
                      <span>–°—Ç—Ä–æ–π–æ–≤–∫–∞</span>
                    </label>
                  </div>

                  <!-- –ü–æ–ª–µ –¥–ª—è –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É —Å—Ç—Ä–æ–π–æ–≤–∫–∏ (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —á–µ–∫–±–æ–∫—Å —É–≤—ñ–º–∫–Ω–µ–Ω–æ) -->
                  <div id="dodatok10-stroiovka-file-section" style="display: none; margin-top: 12px;">
                    <label class="field">
                      <span class="label">–§–∞–π–ª —Å—Ç—Ä–æ–π–æ–≤–∫–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏</span>
                      <div class="row">
                        <input class="input" id="dodatok10-stroiovka-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –∑—ñ —Å—Ç—Ä–æ–π–æ–≤–∫–æ—é..." readonly>
                        <button class="btn" id="dodatok10-select-stroiovka">üìÑ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                      </div>
                    </label>
                  </div>

                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-fix-rank" class="nose">
                      <span>–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤–∞–Ω–Ω—è</span>
                    </label>
                  </div>

                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="dodatok10-fix-position" class="nose">
                      <span>–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ—Å–∞–¥—É</span>
                    </label>
                  </div>

                  <!-- –ü–æ–ª–µ –¥–ª—è –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏ (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ –∑–≤–∞–Ω–Ω—è –∞–±–æ –ø–æ—Å–∞–¥—É) -->
                  <div id="dodatok10-corrections-file-section" style="display: none; margin-top: 12px;">
                    <label class="field">
                      <span class="label">–§–∞–π–ª Excel –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏ –∑–≤–∞–Ω—å/–ø–æ—Å–∞–¥</span>
                      <div class="row">
                        <input class="input" id="dodatok10-corrections-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –∑ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏..." readonly>
                        <button class="btn" id="dodatok10-select-corrections">üìÑ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                      </div>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
              <div class="excel-actions">
                <button class="btn primary" id="dodatok10-process-btn">üöÄ –†–æ–∑–ø–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                <button class="btn ghost" id="dodatok10-cancel-btn" style="display: none;">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              </div>
            </div>
          </div>

          <!-- –õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è –î–æ–¥–∞—Ç–∫—É 10 -->
          <div class="card" style="margin-top: 12px;">
            <div class="log-container">
              <div class="log-header">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div style="display: flex; gap: 8px;">
                  <button class="btn ghost small" id="dodatok10-copy-log" title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                  <button class="btn ghost small" id="dodatok10-clear-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              <pre id="dodatok10-log-body" class="log-body"></pre>
            </div>
          </div>
        </section>

        <section data-route="/zbd" class="route" hidden>
          <div class="card">
            <h3>üìù –ñ–ë–î (–ñ—É—Ä–Ω–∞–ª –ë–æ–π–æ–≤–∏—Ö –î—ñ–π)</h3>
            <p class="subtitle">–û–±—Ä–æ–±–∫–∞ CSV —Ñ–∞–π–ª—ñ–≤ —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è Word –¥–æ–∫—É–º–µ–Ω—Ç—É –∑–∞ –ø–µ–≤–Ω–æ—é –ª–æ–≥—ñ–∫–æ—é</p>

            <div class="excel-container">
              <!-- –í–∏–±—ñ—Ä CSV —Ñ–∞–π–ª—É -->
              <div class="excel-card">
                <h4>üìÑ –í–∏–±—ñ—Ä CSV —Ñ–∞–π–ª—É</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">CSV —Ñ–∞–π–ª –¥–ª—è –æ–±—Ä–æ–±–∫–∏</span>
                    <div class="row">
                      <input class="input" id="zbd-csv-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å CSV —Ñ–∞–π–ª..." readonly>
                      <button class="btn" id="zbd-select-csv">üìÇ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                    </div>
                    <small style="opacity: 0.7; display: block; margin-top: 4px;">
                      –ü—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Ñ–∞–π–ª–∏ —É —Ñ–æ—Ä–º–∞—Ç—ñ .csv
                    </small>
                  </label>
                </div>
              </div>

              <!-- –ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É -->
              <div class="excel-card">
                <h4>üíæ –ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (Word –¥–æ–∫—É–º–µ–Ω—Ç)</span>
                    <div class="row">
                      <input class="input" id="zbd-output-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É..." readonly>
                      <button class="btn" id="zbd-select-output">üíæ –û–±—Ä–∞—Ç–∏ –º—ñ—Å—Ü–µ</button>
                    </div>
                  </label>
                </div>
              </div>

              <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ -->
              <div class="excel-card">
                <h4>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏</h4>
                <div class="form">
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="zbd-autoopen" class="nose" checked>
                      <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
              <div class="excel-actions">
                <button class="btn primary" id="zbd-process-btn">üöÄ –†–æ–∑–ø–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                <button class="btn ghost" id="zbd-cancel-btn" style="display: none;">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              </div>
            </div>
          </div>

          <!-- –õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–ª—è –ñ–ë–î -->
          <div class="card" style="margin-top: 12px;">
            <div class="log-container">
              <div class="log-header">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div style="display: flex; gap: 8px;">
                  <button class="btn ghost small" id="zbd-copy-log" title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                  <button class="btn ghost small" id="zbd-clear-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              <pre id="zbd-log-body" class="log-body"></pre>
            </div>
          </div>
        </section>

        <!-- –°–µ–∫—Ü—ñ—è –®—Ç–∞—Ç_Slice -->
        <section data-route="/shtat-slice" class="route" hidden>
          <div class="card">
            <div class="section-header">
              <h2>üî™ –®—Ç–∞—Ç_Slice - –ù–∞—Ä—ñ–∑–∫–∞ —à—Ç–∞—Ç–∫–∏ –¥–ª—è –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤</h2>
            </div>

            <div class="divider"></div>

            <!-- –í–∏–±—ñ—Ä –≤—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É -->
            <div class="form">
              <label class="field">
                <span class="label">–í—Ö—ñ–¥–Ω–∏–π Excel —Ñ–∞–π–ª</span>
                <div class="row">
                  <input 
                    type="text" 
                    class="input" 
                    id="shtat-slice-input-file" 
                    placeholder="–û–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –¥–ª—è –æ–±—Ä–æ–±–∫–∏..." 
                    readonly
                  />
                  <button class="btn" id="shtat-slice-select-file">üìÇ –û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª</button>
                </div>
              </label>

              <label class="field">
                <span class="label">–ü–∞–ø–∫–∞ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</span>
                <div class="row">
                  <input 
                    type="text" 
                    class="input" 
                    id="shtat-slice-output-folder" 
                    placeholder="–û–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤..." 
                    readonly
                  />
                  <button class="btn" id="shtat-slice-select-folder">üìÅ –û–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                </div>
              </label>
            </div>

            <div class="divider"></div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
            <div class="form">
              <div class="excel-actions">
                <button class="btn primary" id="shtat-slice-process-btn">üöÄ –†–æ–∑–ø–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                <button class="btn ghost" id="shtat-slice-cancel-btn" style="display: none;">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              </div>
            </div>
          </div>

          <!-- –õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è -->
          <div class="card" style="margin-top: 12px;">
            <div class="log-container">
              <div class="log-header">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div style="display: flex; gap: 8px;">
                  <button class="btn ghost small" id="shtat-slice-copy-log" title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                  <button class="btn ghost small" id="shtat-slice-clear-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              <pre id="shtat-slice-log-body" class="log-body"></pre>
            </div>
          </div>
        </section>

        <section data-route="/settings" class="route" hidden>
          <div class="card">
            <h3>Settings</h3>
            <label style="display:flex; gap:8px; align-items:center;">
              –¢–µ–º–∞:
              <select class="input" id="theme-select">
                <option value="dark">Dark</option>
                <option value="light">Light</option>
              </select>
            </label>
          </div>
        </section>
      </main>
    </div>

    <script type="module" src="./main.ts"></script>
  </body>
</html>
