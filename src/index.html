<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline'; script-src 'self'; connect-src 'self'; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KontrNahryuk</title>
    <link rel="stylesheet" href="./styles/ui.css" />
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand">‚ö° –ù–∞—Ö—Ä—é–∫</div>
        <nav class="nav">
          <a href="#/functions" id="nav-func">üìÑ –ù–∞–∫–∞–∑–∏</a>
          <a href="#/excel" id="nav-excel">üìä Excel –æ–±—Ä–æ–±–∫–∞</a>
          <a href="#/updates" id="nav-updates">Updates</a>
          <a href="#/settings" id="nav-settings">Settings</a>
        </nav>
      </aside>

      <header class="topbar">
        <div style="display:flex; gap:8px">
          <button class="btn ghost" id="btn-notify">Notify</button>
          <button class="btn" id="btn-docs">Docs</button>
        </div>
      </header>

      <main class="content">
        
        <!-- License system removed - app is now free and open -->
        <section data-route="/functions" class="route">
          <div class="card">
            <h3>–û–±—Ä–æ–±–∫–∞ –Ω–∞–∫–∞–∑—ñ–≤</h3>

            <!-- –ü–æ–ª–µ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –Ω–∞–∫–∞–∑—É -->
            <div class="form">
              <label class="field">
                <span class="label">–¢–µ–∫—Å—Ç –Ω–∞–∫–∞–∑—É –¥–ª—è –ø–æ—à—É–∫—É</span>
                <textarea 
                  class="input" 
                  id="order-text-input" 
                  placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞–∫–∞–∑—É –∞–±–æ —á–∞—Å—Ç–∏–Ω—É —Ç–µ–∫—Å—Ç—É –¥–ª—è –ø–æ—à—É–∫—É..."
                  rows="3"
                  style="resize: vertical; min-height: 80px;"
                ></textarea>
                <small class="hint">–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç, —è–∫–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö</small>
              </label>
            </div>

            <div class="divider"></div>

            <div class="form grid cols-2">
              <label class="field">
                <span class="label">–î–∂–µ—Ä–µ–ª–æ –¥–ª—è –ø–æ—à—É–∫—É</span>
                <div class="source-selector">
                  <div class="radio-group">
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="single-file" id="source-single" checked>
                      <span class="radio-label">–û–¥–∏–Ω —Ñ–∞–π–ª</span>
                    </label>
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="multiple-files" id="source-multiple">
                      <span class="radio-label">–î–µ–∫—ñ–ª—å–∫–∞ —Ñ–∞–π–ª—ñ–≤</span>
                    </label>
                    <label class="radio-option">
                      <input type="radio" name="source-type" value="folder" id="source-folder">
                      <span class="radio-label">–í—Å—è –ø–∞–ø–∫–∞</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É -->
                  <div class="source-input" id="single-file-input">
                    <label class="file-picker">
                      <input type="file" class="file-input" id="word-file" accept=".doc,.docx" aria-label="–í–∏–±—Ä–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç Word">
                      <span class="file-btn">–í–∏–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª</span>
                      <span class="file-name">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –¥–µ–∫—ñ–ª—å–∫–æ—Ö —Ñ–∞–π–ª—ñ–≤ -->
                  <div class="source-input" id="multiple-files-input" style="display: none;">
                    <label class="file-picker">
                      <input type="file" class="file-input" id="word-files" accept=".doc,.docx" multiple aria-label="–í–∏–±—Ä–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏ Word">
                      <span class="file-btn">–í–∏–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª–∏</span>
                      <span class="file-name">–§–∞–π–ª–∏ –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</span>
                    </label>
                  </div>
                  
                  <!-- –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ -->
                  <div class="source-input" id="folder-input" style="display: none;">
                    <div class="row">
                      <input class="input" id="folder-path" placeholder="–û–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏‚Ä¶" readonly />
                      <button class="btn" id="choose-folder">–û–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                    </div>
                  </div>
                </div>
              </label>

              <label class="field">
                <span class="label">–ú—ñ—Å—Ü–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É</span>
                <div class="row">
                  <input class="input" id="result-path" placeholder="–®–ª—è—Ö –¥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É‚Ä¶" readonly />
                  <button class="btn" id="choose-result">–û–±—Ä–∞—Ç–∏ –º—ñ—Å—Ü–µ‚Ä¶</button>
                </div>
                <small class="hint">–ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–∫—Ä–∏—î —Å–∏—Å—Ç–µ–º–Ω–∏–π –ø—Ä–æ–≤—ñ–¥–Ω–∏–∫</small>
              </label>
            </div>

            <!-- –£–º–æ–≤–Ω–µ –ø–æ–ª–µ Excel –¥–ª—è –†–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è -->
            <div class="section excel-section" id="excel-section" style="display: none;">
              <label class="field">
                <span class="label">Excel —Ñ–∞–π–ª –∑—ñ —Å–ø–∏—Å–∫–æ–º —ñ–º–µ–Ω</span>
                <div class="row">
                  <input class="input" id="excel-path" placeholder="–§–∞–π–ª Excel –∑ —ñ–º–µ–Ω–∞–º–∏‚Ä¶" readonly />
                  <button class="btn" id="choose-excel">–û–±—Ä–∞—Ç–∏ —Ñ–∞–π–ª‚Ä¶</button>
                </div>
                <small class="hint">–ü–æ—Ç—Ä—ñ–±–µ–Ω Excel —Ñ–∞–π–ª –∑ —ñ–º–µ–Ω–∞–º–∏ –¥–ª—è –ø–æ—à—É–∫—É –≤ —Ä–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è—Ö</small>
              </label>
              <div class="divider"></div>
            </div>

            <div class="grid cols-3 toggles">
              <label class="toggle">
                <input type="checkbox" id="t-2bsp" class="nose" checked />
                <span>2–ë–°–ü</span>
              </label>
              <label class="toggle">
                <input type="checkbox" id="t-order" class="nose" />
                <span>–†–æ–∑–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è</span>
              </label>
              <label class="toggle">
                <input type="checkbox" id="t-autopen" class="nose" checked />
                <span>–ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è</span>
              </label>
            </div>

            <div class="divider"></div>
            <div class="actions-bottom">
              <button class="btn primary" id="btn-process-order">–û–±—Ä–æ–±–∏—Ç–∏ –Ω–∞–∫–∞–∑</button>
            </div>

            <div class="log-container">
              <div class="log-header">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div style="display: flex; gap: 8px;">
                  <button class="btn ghost small" id="btn-copy-log" title="–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ª–æ–≥–∏">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
                  <button class="btn ghost small" id="btn-clear-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              <pre id="log-body" class="log-body"></pre>
            </div>
          </div>
        </section>

        <section data-route="/excel" class="route" hidden>
          <div class="card">
            <h3>üìä Excel –æ–±—Ä–æ–±–∫–∞</h3>
            <p class="subtitle">–û–±—Ä–æ–±–∫–∞ Excel —Ñ–∞–π–ª—ñ–≤ –∑ –ø–∞–ø–∫–∏ –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –ª–æ–≥—É–≤–∞–Ω–Ω—è–º</p>
            
            <div class="excel-container">
              <!-- –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏ -->
              <div class="excel-card">
                <h4>üóÇÔ∏è –í–∏–±—ñ—Ä –ø–∞–ø–∫–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–ü–∞–ø–∫–∞ –∑ Excel —Ñ–∞–π–ª–∞–º–∏</span>
                    <div class="row">
                      <input class="input" id="excel-input-folder" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –∑ Excel —Ñ–∞–π–ª–∞–º–∏..." readonly>
                      <button class="btn" id="excel-select-folder">üìÇ –í–∏–±—Ä–∞—Ç–∏ –ø–∞–ø–∫—É</button>
                    </div>
                  </label>
                  
                  <!-- –ü—Ä–∏—Ö–æ–≤–∞–Ω–æ –¥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –∑ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤ -->
                  <!-- <div id="excel-files-preview" class="files-preview" style="display: none;">
                    <h5>–ó–Ω–∞–π–¥–µ–Ω—ñ —Ñ–∞–π–ª–∏:</h5>
                    <div id="excel-files-list" class="files-list"></div>
                  </div> -->
                </div>
              </div>

              <!-- –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è -->
              <div class="excel-card">
                <h4>üíæ –§–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è</h4>
                <div class="form">
                  <label class="field">
                    <span class="label">–û–±–µ—Ä—ñ—Ç—å Excel —Ñ–∞–π–ª –∫—É–¥–∏ –±—É–¥–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</span>
                    <div class="row">
                      <input class="input" id="excel-destination-file" placeholder="–í–∏–±–µ—Ä—ñ—Ç—å —ñ—Å–Ω—É—é—á–∏–π Excel —Ñ–∞–π–ª..." readonly>
                      <button class="btn" id="excel-select-destination">üìÑ –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª</button>
                    </div>
                    <small class="hint">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∞ –≤ –æ–±—Ä–∞–Ω–∏–π —Ñ–∞–π–ª –∑–∞ –≤–∏–±—Ä–∞–Ω–æ—é –ª–æ–≥—ñ–∫–æ—é (–ë–ó/–ó–°/–û–±–∏–¥–≤–∞)</small>
                  </label>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-remember-destination" checked>
                      <span>–ó–∞–ø–∞–º'—è—Ç–∞—Ç–∏ —Ñ–∞–π–ª –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–µ—Å—ñ–π</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏ -->
              <div class="excel-card">
                <h4>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–∫–∏</h4>
                <div class="form">
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-slice-check" checked>
                      <span>Slice_Check</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-mismatches" checked>
                      <span>Mismatches</span>
                    </label>
                  </div>
                  
                  <div class="field checkbox-field">
                    <label>
                      <input type="checkbox" id="excel-sanitizer" checked>
                      <span>Sanitizer</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –†–µ–∂–∏–º –∑–≤–µ–¥–µ–Ω–Ω—è -->
              <div class="excel-card">
                <h4>üìä –†–µ–∂–∏–º –∑–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</h4>
                <div class="form">
                  <div class="field radio-field">
                    <label>
                      <input type="radio" name="excel-mode" value="bz" id="excel-mode-bz">
                      <span>–ë–ó (–ë–æ–π–æ–≤–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è)</span>
                    </label>
                  </div>
                  
                  <div class="field radio-field">
                    <label>
                      <input type="radio" name="excel-mode" value="zs" id="excel-mode-zs">
                      <span>–ó–° (–ó–∞–≥–∞–ª—å–Ω–∞ —Å–ª—É–∂–±–∞)</span>
                    </label>
                  </div>
                  
                  <div class="field radio-field">
                    <label>
                      <input type="radio" name="excel-mode" value="both" id="excel-mode-both" checked>
                      <span>–û–±–∏–¥–≤–∞ —Ä–µ–∂–∏–º–∏</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π -->
              <div class="excel-actions">
                <button class="btn primary" id="excel-process-btn">üöÄ –†–æ–∑–ø–æ—á–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É</button>
                <button class="btn ghost" id="excel-cancel-btn" style="display: none;">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              </div>

              <!-- –õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è -->
              <div class="excel-log">
                <h4>–õ–æ–≥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h4>
                <div class="log-controls">
                  <button class="btn ghost small" id="btn-clear-excel-log">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                  <button class="btn ghost small" id="btn-save-excel-log">–ó–±–µ—Ä–µ–≥—Ç–∏ –ª–æ–≥</button>
                </div>
                <div class="log-container">
                  <pre id="excel-log-body" class="log-body"></pre>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section data-route="/updates" class="route" hidden>
          <div class="card">
            <h3>–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É</h3>
            
            <div class="update-info">
              <div class="version-info">
                <p><strong>–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:</strong> <span id="current-version">1.0.0</span></p>
                <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="update-status">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ó–Ω–∞–π—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"</span></p>
              </div>
              
              <!-- Release Notes –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó (–ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –∑–∞–≤–∂–¥–∏) -->
              <div id="current-release-notes-section" class="release-notes-section" style="margin-top: 16px; display: none;">
                <h5>üìù –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é:</h5>
                <div id="current-release-notes-content" class="release-notes-content" style="max-height: 300px; overflow-y: auto; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-top: 8px;"></div>
              </div>
              
              <div id="update-available" class="update-available" hidden>
                <div class="update-details">
                  <h4>–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞ –≤–µ—Ä—Å—ñ—è: <span id="new-version"></span></h4>
                  <p>–†–æ–∑–º—ñ—Ä: <span id="update-size"></span></p>
                  <p>–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ: <span id="update-date"></span></p>
                  
                  <!-- Release Notes -->
                  <div id="release-notes-section" class="release-notes-section" style="margin-top: 16px; display: none;">
                    <h5>üìù –©–æ –Ω–æ–≤–æ–≥–æ:</h5>
                    <div id="release-notes-content" class="release-notes-content" style="max-height: 300px; overflow-y: auto; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-top: 8px;"></div>
                  </div>
                  
                  <div class="update-actions">
                    <a href="#" id="release-notes" target="_blank" class="link">–°–ø–∏—Å–æ–∫ –∑–º—ñ–Ω</a>
                    <button class="btn primary" id="btn-auto-update">üê∑ –û–Ω–æ–≤–∏—Ç–∏ –ù–∞—Ö—Ä—é–∫</button>
                    <button class="btn ghost" id="btn-manual-download">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Ä—É—á–Ω—É</button>
                  </div>
                </div>
              </div>
              
              <div id="mandatory-update" class="mandatory-update" hidden>
                <div class="alert error">
                  <h4>‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h4>
                  <p>–¶–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º –¥–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏</p>
                  <div class="mandatory-actions">
                    <button class="btn primary" id="btn-mandatory-update">–û–Ω–æ–≤–∏—Ç–∏ –∑–∞—Ä–∞–∑</button>
                    <button class="btn ghost" id="btn-exit-app">–í–∏–π—Ç–∏</button>
                  </div>
                </div>
              </div>
              
              <div id="update-progress" class="update-progress" hidden>
                <div class="progress-info">
                  <h4>üê∑ –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ù–∞—Ö—Ä—é–∫–∞</h4>
                  <p id="progress-text">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                  <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%; transition: width 0.3s ease;"></div>
                  </div>
                  <div class="progress-details">
                    <span id="progress-percent">0%</span>
                    <span id="progress-speed">0 KB/s</span>
                    <span id="progress-size">0 / 0 MB</span>
                  </div>
                </div>
                <div class="progress-actions">
                  <button class="btn ghost" id="btn-cancel-update">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                  <button class="btn ghost" id="btn-restart-after-update" style="display:none;">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏</button>
                </div>
              </div>
              
              <div id="update-error" class="update-error" hidden>
                <div class="alert error">
                  <h4>–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h4>
                  <p id="error-message"></p>
                  <div class="error-actions">
                    <button class="btn" id="btn-retry-update">–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏</button>
                    <button class="btn ghost" id="btn-save-log">–ó–±–µ—Ä–µ–≥—Ç–∏ –ª–æ–≥</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- License section removed - app is now free and open -->
            
            <div class="update-controls">
              <button class="btn" id="btn-check-updates">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è</button>
            </div>
            
            <div class="update-info">
              <div id="update-status">–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è" –¥–ª—è –ø–æ—à—É–∫—É –Ω–æ–≤–∏—Ö –≤–µ—Ä—Å—ñ–π</div>
              <div id="update-details" style="display: none;"></div>
            </div>
          </div>
        </section>

        <section data-route="/settings" class="route" hidden>
          <div class="card">
            <h3>Settings</h3>
            <label style="display:flex; gap:8px; align-items:center;">
              –¢–µ–º–∞:
              <select class="input" id="theme-select">
                <option value="dark">Dark</option>
                <option value="light">Light</option>
              </select>
            </label>
          </div>
        </section>
      </main>
    </div>

    <script type="module" src="./main.ts"></script>
  </body>
</html>
